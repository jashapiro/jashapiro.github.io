{
  "hash": "93c87d8eeef75890a6391a78aac94e6b",
  "result": {
    "markdown": "# Seuss Assembly\n\nLets try an experiment where we try to assemble Green Eggs and Ham by Dr. Seuss from sentence fragments.\nTo make it a bit harder, we will start by removing all punctuation (except Sam-I-am) and making everything upper case.\nThen load in the Dr. Seuss text into an array of words called `seuss`.\nI'm hiding this in the output, but you can see it in the source code for this document.\n\n\n\n\n\nLooking just at the start of the array:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhead(seuss)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"IT\"          \"IS\"          \"INTERESTING\" \"TO\"          \"CONTEMPLATE\"\n[6] \"A\"          \n```\n:::\n:::\n\n\n##Dot plot Lets make a dot plot of Dr. Seuss.\nTo do this we need a matrix of word positions and all the places that they are equal to each other.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(reshape2)\nlibrary(ggplot2)\nsmatrix <- sapply(1:length(seuss), function(s){seuss==seuss[s]})\npoints <- melt(smatrix)\ndots <- subset(points, value)\nqplot(data = dots, \n      x = Var1, y = Var2, \n      xlab = \"Word\", ylab = \"Word\", \n      size = I(1), asp = 1)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: `qplot()` was deprecated in ggplot2 3.4.0.\n```\n:::\n\n::: {.cell-output-display}\n![](darwinAssembly_files/figure-html/dotmatrix-1.png){width=672}\n:::\n:::\n\n\nThat is a bit of a mess, so lets make it nicer and more informative by not using individual words, but phrases of some length.\nWe'll write a function to do this, so we could do it for any text, and any phrase length.\nThen we'll plot the positions where phrase lengths of 3, 5, 10, and 25 words repeat.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nphraseDotPlot <- function(words, l){\n  phrases <- sapply(1:(length(words) - (l - 1)),\n                 function(p){paste0(words[p:(p+l-1)], collapse = \" \")})\n  phrase_matrix <- sapply(1:length(phrases), function(p){phrases==phrases[p]})\n  points <- melt(phrase_matrix)\n  dots <- subset(points, value)\n  qplot(data = dots, \n      x = Var1, y = Var2, \n      xlab = \"Phrase\", ylab = \"Phrase\", \n      size = I(1), asp = 1, main = sprintf(\"%d word phrases\", l)\n      )\n}\n\nphraseDotPlot(seuss, 3)\n```\n\n::: {.cell-output-display}\n![](darwinAssembly_files/figure-html/dotplot3-1.png){width=672}\n:::\n\n```{.r .cell-code}\nphraseDotPlot(seuss, 5)\n```\n\n::: {.cell-output-display}\n![](darwinAssembly_files/figure-html/dotplot3-2.png){width=672}\n:::\n\n```{.r .cell-code}\nphraseDotPlot(seuss, 10)\n```\n\n::: {.cell-output-display}\n![](darwinAssembly_files/figure-html/dotplot3-3.png){width=672}\n:::\n\n```{.r .cell-code}\nphraseDotPlot(seuss, 25)\n```\n\n::: {.cell-output-display}\n![](darwinAssembly_files/figure-html/dotplot3-4.png){width=672}\n:::\n:::\n\n\nLets start with random 3 word phrases, but only from the first 133 words.\nSo we can start with any position from 1:131, then take the next three words, concatenate them (with a space), and those will be our \"reads\".\nLets start with 100 reads.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nl = 3\nn = 500\nstarts <- sample(1:(length(seuss)-(l-1)), size = n, replace = T)\nfragments <- sapply(starts, function(s){paste0(seuss[s:(s+l-1)], collapse = \" \")})\n\nhead(fragments)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"THROUGH THE DAMP\"        \"A MANNER HAVE\"          \n[3] \"FROM EACH OTHER\"         \"CHARACTER AND THE\"      \n[5] \"HIGHER ANIMALS DIRECTLY\" \"THE DAMP EARTH\"         \n```\n:::\n:::\n",
    "supporting": [
      "darwinAssembly_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}